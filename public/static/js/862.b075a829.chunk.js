"use strict";(self.webpackChunkdemo1=self.webpackChunkdemo1||[]).push([[862],{38862:(e,a,s)=>{s.r(a),s.d(a,{default:()=>b});var t=s(65043),l=s(97),r=s(99442),n=s(424),c=s(15627),i=s(30460),o=s(48414),d=s(94539),m=s(98239),h=s(44864),x=s(70579);let p="",u="";const b=(0,r.y)((()=>{const e=(0,l.A)(),a=(0,r.W6)(),[s,b]=(0,t.useState)(!1),[j,f]=(0,t.useState)(!1),[N,g]=(0,t.useState)(!1),[v,y]=(0,t.useState)([]),[w,A]=(0,t.useState)([]),[S,k]=(0,t.useState)([]),[C,R]=(0,t.useState)(""),[_,T]=(0,t.useState)(""),[O,E]=(0,t.useState)([]),[D,I]=(0,t.useState)(""),[M,P]=(0,t.useState)(""),[q,F]=(0,t.useState)([]),[B,z]=(0,t.useState)({}),[J,U]=(0,t.useState)(!1);(0,t.useEffect)((()=>{J||(p&&p.includes("Administrator")?(b(!0),H()):a.push({pathname:"/home"}),U(!0))}),[]);const H=()=>{fetch("".concat(h.u.MAIN_ENDPOINT,"/api/roles"),{method:"get",headers:{Authorization:"Bearer ".concat(u),Accept:"application/json","Content-Type":"application/json"}}).then((function(e){if(200!=e.status)return localStorage.clear(),void window.location.reload();e.json().then((function(e){let a=new Array;e.data.all_permissions.map((e=>{let s={value:e.id,label:e.name};a.push(s)})),y(e.data.role_with_permission),A(e.data.role_with_permission),k(a),b(!1)}))})).catch((function(e){console.log("Fetch Error :-S",e),b(!1)}))};return u=JSON.parse(localStorage.getItem("portalUserDataToken")||""),p=JSON.parse(localStorage.getItem("portalUserDataRole")||""),(0,x.jsx)(t.Fragment,{children:1==s?(0,x.jsx)(t.Fragment,{children:(0,x.jsx)(i.A,{loading:s,active:!0})}):(0,x.jsxs)(t.Fragment,{children:[(0,x.jsxs)("ol",{className:"breadcrumb breadcrumb-dot fs-6 fw-bold",style:{margin:"1%"},children:[(0,x.jsx)(n.N_,{to:"/home",className:"pe-1 cursor-pointer",children:(0,x.jsx)("li",{className:"breadcrumb-item pe-1",children:"Home"})}),"/ \xa0",(0,x.jsx)("li",{className:"breadcrumb-item pe-3",children:"Role Management"})]}),(0,x.jsx)(o.sT,{breadcrumbs:[],children:e.formatMessage({id:"MENU.DASHBOARD"})}),(0,x.jsx)("div",{className:"row g-5 gx-xxl-8",style:{marginTop:"1%"},children:(0,x.jsx)("div",{className:"col-xxl-12",children:(0,x.jsxs)("div",{className:"card",children:[(0,x.jsxs)("div",{className:"card-header border-0 pt-2",children:[(0,x.jsx)("h3",{className:"card-title align-items-start flex-column",children:(0,x.jsx)("span",{className:"card-label fw-bolder fs-3 mb-1",style:{color:"rgb(138, 38, 80)"},children:"Roles"})}),(0,x.jsx)("div",{className:"card-toolbar",children:(0,x.jsx)("input",{type:"search",onChange:e=>{let a=e.target.value,s=new Array;v.map(((e,t)=>{e.name.toLowerCase().includes(a.toLowerCase())&&s.push(e)})),y(s),""==a&&y(w)},className:"form-control form-control-solid",placeholder:"Search by  Title "})}),(0,x.jsx)("div",{className:"card-toolbar","data-bs-toggle":"tooltip","data-bs-placement":"top","data-bs-trigger":"hover",title:"Click to add new Role",children:(0,x.jsxs)("a",{href:"#",className:"btn btn-sm btn-primary","data-bs-toggle":"modal","data-bs-target":"#add_role",children:[(0,x.jsx)(d.aO,{path:"/media/icons/duotune/arrows/arr075.svg",className:"svg-icon-3"}),"New Role"]})})]}),(0,x.jsx)("div",{className:"card-body py-3",children:(0,x.jsx)("div",{className:"table-responsive h-600px",children:(0,x.jsxs)("table",{className:"table table-row-dashed table-row-gray-300 align-middle gs-0 gy-4",children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{className:"fw-bolder text-muted",children:[(0,x.jsx)("th",{className:"w-25px"}),(0,x.jsx)("th",{className:"min-w-100px",children:"Title"}),(0,x.jsx)("th",{className:"min-w-100px",children:"Permission"}),(0,x.jsx)("th",{className:"min-w-80px text-end",children:"Status"}),(0,x.jsx)("th",{className:"min-w-50px text-end",children:"Edit"})]})}),(0,x.jsx)("tbody",{children:void 0!=v&&v.map((e=>(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{}),(0,x.jsx)("td",{children:(0,x.jsx)("span",{className:"text-dark fw-bolder text-hover-primary d-block fs-6",children:e.name})}),(0,x.jsx)("td",{children:e.permissions.map((e=>(0,x.jsx)("span",{className:"badge badge-light-primary fs-6 fw-bolder m-1",children:e.name})))}),(0,x.jsx)("td",{children:(0,x.jsxs)("div",{className:"d-flex justify-content-end flex-shrink-0",children:[(0,x.jsx)("div",{className:"form-check form-switch",title:1==e.is_deleted?"Activate Role":"Deactivate Role",children:(0,x.jsx)("input",{className:"form-check-input",disabled:"Administrator"==e.name,type:"checkbox",id:"flexSwitchCheckChecked",checked:1!=e.is_deleted,onChange:()=>(e=>{b(!0);try{fetch("".concat(h.u.MAIN_ENDPOINT,"/api/delete-role/").concat(e.id),{method:"delete",headers:{Authorization:"Bearer ".concat(u),Accept:"application/json","Content-Type":"application/json"}}).then((function(e){e.json().then((function(e){1==e.success?(c.Ay.success(e.message),H(),b(!1)):(c.Ay.error(e.message),H(),b(!1))}))})).catch((function(e){b(!1)}))}catch(a){console.log("ERR>>>",a)}})(e)})}),"\xa0"]})}),(0,x.jsx)("td",{children:(0,x.jsxs)("div",{className:"d-flex justify-content-end flex-shrink-0",children:["\xa0",(0,x.jsx)("a",{className:"btn btn-icon btn-bg-light btn-active-color-primary btn-sm me-1","data-kt-menu-trigger":"click","data-bs-toggle":"modal","data-bs-target":"#edit_role",onClick:()=>(e=>{let a=[];e.permissions.map((e=>{a.push({value:e.id,label:e.name})})),I(e.name),P(e.name),F(a),z(e)})(e),children:(0,x.jsx)(d.aO,{path:"/media/icons/duotune/art/art005.svg",className:"svg-icon-3"})})]})})]})))})]})})})]})})}),(0,x.jsx)("div",{className:"modal fade",id:"add_role","aria-hidden":"true",children:(0,x.jsx)("div",{className:"modal-dialog mw-650px",children:(0,x.jsxs)("div",{className:"modal-content",children:[(0,x.jsx)("div",{className:"modal-header pb-0 border-0 justify-content-end",children:(0,x.jsx)("div",{className:"btn btn-sm btn-icon btn-active-color-primary","data-bs-dismiss":"modal",children:(0,x.jsx)(d.aO,{path:"/media/icons/duotune/arrows/arr061.svg",className:"svg-icon-1"})})}),(0,x.jsxs)("div",{className:"modal-body scroll-y mx-5 mx-xl-18 pt-0 pb-15",children:[(0,x.jsx)("div",{className:"text-center mb-13",children:(0,x.jsx)("h1",{className:"mb-3",children:"Add New Role"})}),(0,x.jsxs)("form",{className:"createRole",children:[(0,x.jsxs)("div",{className:"fv-row mb-10",children:[(0,x.jsx)("label",{className:"form-label fs-6 fw-bolder required text-dark text-left",children:"Title :"}),(0,x.jsx)("input",{className:"form-control form-control-solid",type:"input",value:C,onChange:e=>R(e.target.value),onFocus:()=>g(!1),placeholder:""}),1==N?(0,x.jsx)("span",{role:"alert",className:"text-danger",children:"Title is required"}):null]}),(0,x.jsxs)("div",{className:"fv-row mb-10",children:[(0,x.jsx)("label",{className:"form-label fs-6 fw-bolder required text-dark text-left",children:"Permission :"}),(0,x.jsx)(m.Ay,{value:O,isMulti:!0,onChange:e=>E(e),options:S,onFocus:()=>f(!1)}),1==j?(0,x.jsx)("span",{role:"alert",className:"text-danger",children:"Permission is required"}):null]}),(0,x.jsxs)("div",{className:"fv-row mb-10",children:[(0,x.jsx)("label",{className:"form-label fs-6 fw-bolder text-dark text-left",children:"Description :"}),(0,x.jsx)("input",{type:"input",value:_,onChange:e=>T(e.target.value),className:"form-control form-control-solid",placeholder:""})]}),(0,x.jsx)("button",{type:"button",onClick:()=>{if(""!=C&&O.length>0){let a=new Array;O.map((e=>{a.push(e.label)}));const s={name:"".concat(C),permission:a,description:"".concat(_)};try{fetch("".concat(h.u.MAIN_ENDPOINT,"/api/create-role"),{method:"post",headers:{Authorization:"Bearer ".concat(u),Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(s)}).then((function(e){e.text().then((function(e){e&&(H(),b(!1),R(""),E([]),T(""),c.Ay.success("Role Created Successfully"))})),204==e.status&&(H(),b(!1),R(""),E([]),T(""),c.Ay.error("Role Already Exist ! "))})).catch((function(e){b(!1)}))}catch(e){}$("#add_role").modal("hide"),R(""),T(""),E([])}else""==C&&g(!0),""==O&&f(!0)},className:"btn btn-primary",children:"Submit"})]})]})]})})}),(0,x.jsx)("div",{className:"modal fade",id:"edit_role","aria-hidden":"true",children:(0,x.jsx)("div",{className:"modal-dialog mw-650px",children:(0,x.jsxs)("div",{className:"modal-content",children:[(0,x.jsx)("div",{className:"modal-header pb-0 border-0 justify-content-end",children:(0,x.jsx)("div",{className:"btn btn-sm btn-icon btn-active-color-primary","data-bs-dismiss":"modal",children:(0,x.jsx)(d.aO,{path:"/media/icons/duotune/arrows/arr061.svg",className:"svg-icon-1"})})}),(0,x.jsxs)("div",{className:"modal-body scroll-y mx-5 mx-xl-18 pt-0 pb-15",children:[(0,x.jsx)("div",{className:"text-center mb-13",children:(0,x.jsx)("h1",{className:"mb-3",children:"Edit Role"})}),(0,x.jsxs)("form",{className:"form",children:[(0,x.jsxs)("div",{className:"fv-row mb-10",children:[(0,x.jsx)("label",{className:"form-label fs-6 fw-bolder required text-dark text-left",children:"Title :"}),(0,x.jsx)("input",{className:"form-control form-control-solid",type:"input",value:D,onChange:e=>I(e.target.value),onFocus:()=>g(!1),placeholder:""}),1==N?(0,x.jsx)("span",{role:"alert",className:"text-danger",children:"Role Title is Required"}):null]}),(0,x.jsxs)("div",{className:"fv-row mb-10",children:[(0,x.jsx)("label",{className:"form-label fs-6 fw-bolder required text-dark text-left",children:"Permission :"}),(0,x.jsx)(m.Ay,{value:q,isMulti:!0,onChange:e=>F(e),options:S,onFocus:()=>f(!1)}),1==j?(0,x.jsx)("span",{role:"alert",className:"text-danger",children:"Permission is Required"}):null]}),(0,x.jsxs)("div",{className:"fv-row mb-10",children:[(0,x.jsx)("label",{className:"form-label fs-6 fw-bolder text-dark text-left",children:"Description :"}),(0,x.jsx)("input",{type:"input",value:M,onChange:e=>P(e.target.value),className:"form-control form-control-solid",placeholder:""})]}),(0,x.jsx)("button",{type:"button",onClick:()=>{if(""!=D&&q.length>0){let a=new Array;q.map((e=>{a.push(e.label)}));const s={name:"".concat(D),permission:a,description:"".concat(M)};let t=JSON.stringify(s);try{fetch("".concat(h.u.MAIN_ENDPOINT,"/api/update-role/").concat(B.id),{method:"put",headers:{Authorization:"Bearer ".concat(u),Accept:"application/json","Content-Type":"application/json"},body:t}).then((function(e){e.json().then((function(e){H(),c.Ay.success(e.message),I(""),P(""),F(""),b(!1)})),204==e.status&&(I(""),P(""),F(""),b(!1),c.Ay.error("Role Already Exist ! "))})).catch((function(e){b(!1)}))}catch(e){}$("#edit_role").modal("hide")}else""==D&&g(!0),""==q&&f(!0)},className:"btn btn-primary",children:"Submit"})]})]})]})})})]})})}))}}]);
//# sourceMappingURL=862.b075a829.chunk.js.map