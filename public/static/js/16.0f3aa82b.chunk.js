"use strict";(self.webpackChunkdemo1=self.webpackChunkdemo1||[]).push([[16],{63016:(e,t,a)=>{a.r(t),a.d(t,{default:()=>k});var n=a(65043),o=a(94406),c=a(50525),s=a(50289),d=a(60521),r=a(35696),l=a(15627),i=a(47419),m=a(64435),u=a(89421),h=a(67289),p=a(10804),y=a(17116),x=a(424),j=a(86178),g=a.n(j),f=a(44864),A=a(70579);const{Option:b}=o.A,{RangePicker:N}=c.A,v=n.createContext(null);let C="";const S=e=>{let{index:t,...a}=e;const[n]=s.A.useForm();return(0,A.jsx)(s.A,{form:n,component:!1,children:(0,A.jsx)(v.Provider,{value:n,children:(0,A.jsx)("tr",{...a})})})},I=e=>{let{title:t,editable:a,children:o,dataIndex:c,record:r,handleSave:l,...i}=e;const[m,u]=(0,n.useState)(!1),h=(0,n.useRef)(null),p=(0,n.useContext)(v);(0,n.useEffect)((()=>{var e;m&&(null===(e=h.current)||void 0===e||e.focus())}),[m]);const y=()=>{u(!m),p.setFieldsValue({[c]:r[c]})},x=async()=>{try{const e=await p.validateFields();y(),l({...r,...e})}catch(e){console.log("Save failed:",e)}};let j=o;return a&&(j=m?(0,A.jsx)(s.A.Item,{style:{margin:0},name:c,rules:[{required:!0,message:"".concat(t," is required.")}],children:(0,A.jsx)(d.A,{ref:h,onPressEnter:x,onBlur:x})}):(0,A.jsx)("div",{className:"editable-cell-value-wrap",style:{paddingRight:24},onClick:y,children:o})),(0,A.jsx)("td",{...i,children:j})},_=[{title:"Agg Code",dataIndex:"ac4",key:"ac4",sorter:!0,render:(e,t)=>(0,A.jsx)(r.A,{placement:"topLeft",title:"View Product Page",children:(0,A.jsx)(x.N_,{to:{pathname:"/product",state:{prod_id:t.productpage_id,data:t}},children:e})})},{title:"Spot Code",dataIndex:"spot",key:"spot",sorter:!0},{title:"Comment",dataIndex:"comment",key:"comment",sorter:!0,editable:!0},{title:"Added by",dataIndex:"created_by",key:"created_by",sorter:!0},{title:"Added on",dataIndex:"created_on",key:"created_on",sorter:!0,render:e=>e?g()(e).format("DD-MMM-YYYY"):(0,A.jsx)(A.Fragment,{children:"-"})}],k=e=>{const[t]=s.A.useForm(),[a,c]=(0,n.useState)([]),[r,j]=(0,n.useState)(1),[v,k]=(0,n.useState)(!1),[R,w]=(0,n.useState)(1),[P,T]=(0,n.useState)(null),[O,D]=(0,n.useState)([]),[Y,E]=(0,n.useState)({columnKey:"created_on",order:"descend"});(0,n.useEffect)((()=>{M()}),[Y,R]);const M=async()=>{k(!0);let e="/api/get-comments/".concat(R,"/").concat(Y&&Y.columnKey?Y.columnKey:"created_on","/").concat(Y&&Y.order&&"ascend"==Y.order?1:0),t=await(0,y.O)(e);t&&t.message&&(console.log(t,"response"),D(t.data.users),c(t.data.comments),j(t.data.comments_count),k(!1))},F={body:{row:S,cell:I}},z=_.map((e=>e.editable?{...e,onCell:t=>({record:t,editable:e.editable,dataIndex:e.dataIndex,title:e.title,handleSave:B})}:e)),B=e=>{let t={content:e.comment};try{fetch("".concat(f.u.MAIN_ENDPOINT,"/api/update-task-comment/").concat(e.comment_id),{method:"put",headers:{Authorization:"Bearer ".concat(C),Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)}).then((function(e){200==e.status&&e.json().then((function(e){l.Ay.success(e.message),M()}))})).catch((function(e){}))}catch(a){console.log("ERR>>>",a)}};return C=JSON.parse(localStorage.getItem("portalUserDataToken")||""),(0,A.jsx)(A.Fragment,{children:(0,A.jsx)("div",{className:"pt-4 m-2",children:(0,A.jsx)("div",{className:"card",children:(0,A.jsxs)("div",{className:"card-body py-3 ",children:[(0,A.jsxs)("div",{className:"row m-4 p-2",children:[(0,A.jsx)("span",{className:"card-label fw-bolder fs-3 mb-1",style:{color:"rgb(138, 38, 80)"},children:"Comments"}),(0,A.jsx)(i.A,{children:(0,A.jsx)(s.A,{layout:"inline",name:"horizontal_login",onFinish:e=>{var t={added_by:e.addedby,keyword:e.keyword,from_date:null!==e&&void 0!==e&&e.dateRange?g()(e.dateRange[0]).format("YYYY-MM-DD"):"",to_date:null!==e&&void 0!==e&&e.dateRange?g()(e.dateRange[1]).format("YYYY-MM-DD"):""};try{fetch("".concat(f.u.MAIN_ENDPOINT,"/api/search-product-comment/").concat(R,"/").concat(Y&&Y.columnKey?Y.columnKey:"created_on","/").concat(Y&&Y.order&&"ascend"==Y.order?1:0),{method:"post",headers:{Authorization:"Bearer ".concat(C),Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)}).then((function(e){200==e.status&&e.json().then((function(e){c(e.data.comments),j(e.data.rowCnt)}))})).catch((function(e){}))}catch(a){console.log("ERR>>>",a)}},form:t,children:(0,A.jsxs)(m.A,{children:[(0,A.jsx)(s.A.Item,{name:"dateRange",children:(0,A.jsx)(N,{})}),(0,A.jsx)(s.A.Item,{name:"keyword",children:(0,A.jsx)(d.A,{placeholder:"AC4/Product Code/Comment text"})}),(0,A.jsx)(s.A.Item,{name:"addedby",children:(0,A.jsx)(o.A,{placeholder:"Please Select Added By",value:P,onChange:e=>{T(e)},children:O.map((e=>(0,A.jsx)(b,{value:e.id,children:e.username})))})}),(0,A.jsx)(u.A,{type:"primary",htmlType:"submit",children:"Submit"}),(0,A.jsx)(u.A,{type:"primary",onClick:()=>{w(1),M(),t.resetFields()},htmlType:"reset",children:"Reset"}),(0,A.jsx)(x.N_,{to:{pathname:"/home"},children:(0,A.jsx)(u.A,{type:"primary",children:"Back To Home"})})]})})})]}),(0,A.jsx)("div",{className:"tab-content",id:"myTabContent",children:(0,A.jsxs)("div",{className:"tab-pane fade show active ",id:"",role:"tabpanel",children:[(0,A.jsx)(h.A,{columns:z,components:F,dataSource:a,loading:v,onChange:(e,t,a,n)=>{E({...a})},scroll:{x:"auto",y:"auto"},pagination:!1}),(0,A.jsx)("div",{className:"row text-end m-4",children:(0,A.jsx)(p.A,{defaultCurrent:R,defaultPageSize:10,current:R,total:r,onChange:e=>{w(e)},hideOnSinglePage:!0,showSizeChanger:!1})})]})})]})})})})}},17116:(e,t,a)=>{a.d(t,{O:()=>c,i:()=>s});var n=a(44864);const o=JSON.parse(localStorage.getItem("portalUserDataToken")||""),c=e=>new Promise(((t,a)=>{try{fetch("".concat(n.u.MAIN_ENDPOINT).concat(e),{method:"get",headers:{Authorization:"Bearer ".concat(o),Accept:"application/json","Content-Type":"application/json"}}).then((e=>{e.json().then((function(e){t(e)}))})).catch((function(e){console.log("Request failed",e)}))}catch(c){console.log("ERR>>>",c)}})),s=(e,t)=>new Promise(((a,c)=>{try{fetch("".concat(n.u.MAIN_ENDPOINT).concat(e),{method:"Post",headers:{Authorization:"Bearer ".concat(o),Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)}).then((e=>{e.json().then((function(e){a(e)}))})).catch((function(e){console.log("Request failed",e)}))}catch(s){console.log("ERR>>>",s)}}))},47419:(e,t,a)=>{a.d(t,{A:()=>n});const n=a(28821).A}}]);
//# sourceMappingURL=16.0f3aa82b.chunk.js.map